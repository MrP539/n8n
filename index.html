<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>n8n Demo Workflow</title>
    <!-- โหลด n8n-demo Web Component จาก CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.0.0/webcomponents-loader.js"></script>
    <script src="https://www.unpkg.com/lit@2.0.0-rc.2/polyfill-support.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@n8n_io/n8n-demo-component/n8n-demo.bundled.js"></script>
</head>
<body>
    <n8n-demo></n8n-demo>

    <script>
        const workflowData = {
  "nodes": [
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "7tMqf254LYefoBEc",
          "mode": "list",
          "cachedResultName": "test query booking"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "ignoreTypeMismatchErrors": false,
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {
          "waitForSubWorkflow": true
        }
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        2560,
        80
      ],
      "id": "01e7fa42-baec-46cc-a2cc-f815bb54e50e",
      "name": "Execute Workflow"
    },
    {
      "parameters": {
        "numberInputs": 5
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [
        1640,
        40
      ],
      "id": "c15f0d95-556f-4103-88ab-eac13b7568af",
      "name": "Merge2"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "d950cd55-3064-4035-940a-bbe8c683cdab",
      "name": "Aggregate2",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        1800,
        80
      ]
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\"result\":[\"{{ $json.data[0].candidates[0].content.parts[0].text.trim() }}\",\"{{ $json.data[1].candidates[0].content.parts[0].text.trim() }}\",\"{{ $json.data[2].candidates[0].content.parts[0].text.trim() }}\",\"{{ $json.data[3].candidates[0].content.parts[0].text.trim() }}\",\"{{ $json.data[4].candidates[0].content.parts[0].text.trim() }}\"]}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1960,
        80
      ],
      "id": "d7a94f3a-df5e-41f5-a0aa-c6376597fd4b",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "\nreturn {\"result\":list(set(_input.all()[0].json[\"result\"]))}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2100,
        80
      ],
      "id": "33706142-d5c0-43a5-8685-02df759320f8",
      "name": "Code2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "AIzaSyCIsx06N1DPeMh4wwkLFceNbgjUpkmywIc"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \"นำ {{ $json.result }} ไปประกอบการวิเคราะห์ป้ายทะเบียนของรถในวิดีโอ จากนั้นประเมิน ว่าข้อมูลใดมีความน่าจะเป็นและถูกต้องที่สุด (ให้ความสำคัญกับข้อมูลที่ให้ไปก่อนเป็นอันดับแรก)\"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $('Aggregate').item.json.data[0].mime_type }}\",\n            \"file_uri\": \"{{ $('Aggregate').item.json.data[0].uri }}\"\n          }\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $('Aggregate').item.json.data[1].mime_type}}\",\n            \"file_uri\": \"{{ $('Aggregate').item.json.data[1].uri }}\"\n          }\n        }\n      ]\n    }\n  ],\n\"generationConfig\": {\n    \"temperature\": 0.2,\n    \"topK\": 10,\n    \"topP\": 0.8,\n    \"maxOutputTokens\": 500,\n    \"responseMimeType\": \"text/plain\"\n},\n    \"system_instruction\": {\n        \"parts\": {\"text\":\"Setting:\\n- Task type: License Plate Recognition\\n- Priority: Prioritize maximum accuracy for Thai character recognition over speed.\\n\\nCommand:\\n- First, Read all frames in the video and focus only on the closest car in the video.\\n- Second, focus on the License Plate of the focused car.\\n- Third, Improve the quality of the focused license plate before reading, such as adjusting contrast, reducing noise, or adjusting brightness, and apply any relevant image processing techniques for clearer text.\\n- Fourth, read the focused license plate carefully and use OCR techniques that can handle skewness, distortion, *and specifically Thai characters with overlapping or similar shapes, especially [ย, ฉ, ธ, บ, ษ]*. Apply character segmentation methods if necessary. **Pay very close attention to the nuances of Thai characters, particularly the loop and tail structures which distinguish ย from ฉ. Employ a secondary character verification algorithm focused on the subtle differences between these commonly confused glyphs.**\\n- Fifth, Optimize the inspection even in conditions of angles or uneven lighting *by attempting to rectify perspective and compensate for shadows and glare for a clearer view*. Prioritize accuracy over speed in inspection.\\n- *Sixth, Before providing final result, apply a cross validation method by re-analyzing the results with enhanced algorithm. If any doubt arise, please re-analyze the text again. **Include a dedicated analysis step specifically comparing characters that are likely to be confused (e.g., ย/ฉ, ธ/บ, ย/ษ, ย/บ ,ผ/พ ,ข/บ) using a comparative feature mapping algorithm to maximize accurate recognition.** *\\n- Finally: Respond according to the Output topic specification according to the Example output topic format only .\\n\\nRequirements:\\n- All frames in the video must be read and analyzed one by one.\\n- The angle and lighting of the image may not be symmetrical, the system should try to improve the reading and inspection through image processing.\\n- Analyze carefully if you encounter the following letters in particular [ย, ฉ, ธ], and double check if possible with character recognition engine for Thai. **Implement a probabilistic character scoring system that favors characters with the most similar features and highest confidence scores after applying all corrective measures.**\\n- Make sure to be as accurate as possible, **even if it means taking extra time on difficult plates. Focus the character recognition engine with a specialized model for Thai text which is capable of handling the nuanced shapes.**\\n- All information must be carefully verified and compiled for further evaluation by the vehicle owner or experts. *The goal is to provide a high-accuracy result for vehicle identification.*\\n\\nSupporting Information for Analysis:\\n\\n1. **ส่วนหัวของตัวอักษร:** ส่วนหัวของ \\\"ร\\\" เป็นเส้นโค้งเปิดด้านล่าง ซึ่งไม่มีลูปปิดเหมือนกับตัวอักษร \\\"ธ\\\" การตรวจสอบนี้เป็นขั้นตอนแรกที่สำคัญในการแยกแยะความแตกต่างระหว่าง \\\"ร\\\" และ \\\"ธ\\\"\\n\\n2. **เส้นแนวนอนที่ฐาน:** อักษร \\\"ร\\\" ไม่มีเส้นแนวนอนที่ฐาน ในขณะที่อักษร \\\"ธ\\\" จะมีเส้นแนวนอนที่ฐานอย่างชัดเจน การไม่มีเส้นแนวนอนที่ฐานนี้เป็นอีกหนึ่งปัจจัยสำคัญที่ทำให้มั่นใจว่าอักษรนี้คือ \\\"ร\\\"\\n\\n3. **ลักษณะเชิงโครงสร้าง:** ตัวอักษร \\\"ร\\\" มีลักษณะที่บางและเล็กกว่าเมื่อเทียบกับ \\\"ธ\\\" การเปรียบเทียบขนาดและความหนาของตัวอักษรนี้ช่วยในการยืนยันความถูกต้องของการระบุตัวอักษร\\n\\n4. **การใช้เทคนิค OCR เฉพาะสำหรับภาษาไทย:** โมเดล OCR ที่ใช้ได้รับการฝึกฝนมาสำหรับภาษาไทยโดยเฉพาะ ทำให้สามารถจดจำและแยกแยะลักษณะเฉพาะของ \\\"ร\\\" ได้อย่างแม่นยำมากขึ้น\\n\\n5. **การตรวจสอบซ้ำด้วยอัลกอริทึมพิเศษ:** หลังจากที่ OCR ทำการอ่านครั้งแรก ระบบได้ทำการตรวจสอบซ้ำโดยใช้อัลกอริทึม feature mapping เพื่อเปรียบเทียบคุณลักษณะของตัวอักษรที่อ่านได้กับต้นแบบของ \\\"ร\\\" และ \\\"ธ\\\" อีกครั้ง เพื่อให้มั่นใจว่าการระบุตัวอักษรนั้นถูกต้องและมีความแม่นยำสูงสุด\\n\\n\\nOutput:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : Show the problem\\n- if License plate is can read and confident output of License Plate Recognition is high : Show result in this format \\\"<result>\\\"[if result is have \\\" \\\" : replace  \\\" \\\" to \\\"\\\"] is in Thai language \\n\\nExample output:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : ไม่สามารถอ่านป้ายทะเบียนได้เนื่องจากอักษรและตัวเลขของป้ายทะเบียนนั้นหายไป\\n- if License plate is can read and confident output of License Plate Recognition is high : ผจ1234\\n\\n[!!! Respond according to the Output topic specification according to the Example output topic format only . Do not create  additional format text in the Response. !!!]\"\n}\n    }\n\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "765c53f1-8c6f-4f99-9824-cc8ec2f2efd7",
      "name": "Gemini_2_flash_exp_CDA2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2260,
        80
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "AIzaSyCIsx06N1DPeMh4wwkLFceNbgjUpkmywIc"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \" \"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $json.data[0].mime_type }}\",\n            \"file_uri\": \"{{ $json.data[0].uri }}\"\n          }\n        },\n        {\n          \"fileData\": {\n            \"mimeType\": \"{{$json.data[1].mime_type }}\",\n            \"fileUri\": \"{{ $json.data[1].uri }}\"\n            \n          }\n        }\n      ]\n    }\n  ],\n    \"generationConfig\": {\n        \"temperature\": 0.2,\n        \"topK\": 10,\n        \"topP\": 0.8,\n        \"maxOutputTokens\": 500,\n        \"responseMimeType\": \"text/plain\"\n    },\n    \"system_instruction\": {\n        \"parts\": {\"text\":\"Setting:\\n- Task type: License Plate Recognition\\n- Priority: Prioritize maximum accuracy for Thai character recognition over speed.\\n\\nCommand:\\n- First, Read all frames in the video and focus only on the closest car in the video.\\n- Second, focus on the License Plate of the focused car.\\n- Third, Improve the quality of the focused license plate before reading, such as adjusting contrast, reducing noise, or adjusting brightness, and apply any relevant image processing techniques for clearer text.\\n- Fourth, read the focused license plate carefully and use OCR techniques that can handle skewness, distortion, *and specifically Thai characters with overlapping or similar shapes, especially [ย, ฉ, ธ, บ, ษ]*. Apply character segmentation methods if necessary. **Pay very close attention to the nuances of Thai characters, particularly the loop and tail structures which distinguish ย from ฉ. Employ a secondary character verification algorithm focused on the subtle differences between these commonly confused glyphs.**\\n- Fifth, Optimize the inspection even in conditions of angles or uneven lighting *by attempting to rectify perspective and compensate for shadows and glare for a clearer view*. Prioritize accuracy over speed in inspection.\\n- *Sixth, Before providing final result, apply a cross validation method by re-analyzing the results with enhanced algorithm. If any doubt arise, please re-analyze the text again. **Include a dedicated analysis step specifically comparing characters that are likely to be confused (e.g., ย/ฉ, ธ/บ) using a comparative feature mapping algorithm to maximize accurate recognition.** *\\n- Finally: Respond according to the Output topic specification according to the Example output topic format only .\\n\\nRequirements:\\n- All frames in the video must be read and analyzed one by one.\\n- The angle and lighting of the image may not be symmetrical, the system should try to improve the reading and inspection through image processing.\\n- Analyze carefully if you encounter the following letters in particular [ย, ฉ, ธ], and double check if possible with character recognition engine for Thai. **Implement a probabilistic character scoring system that favors characters with the most similar features and highest confidence scores after applying all corrective measures.**\\n- Make sure to be as accurate as possible, **even if it means taking extra time on difficult plates. Focus the character recognition engine with a specialized model for Thai text which is capable of handling the nuanced shapes.**\\n- All information must be carefully verified and compiled for further evaluation by the vehicle owner or experts. *The goal is to provide a high-accuracy result for vehicle identification.*\\n\\nSupporting Information for Analysis:\\n\\n1. **ส่วนหัวของตัวอักษร:** ส่วนหัวของ \\\"ร\\\" เป็นเส้นโค้งเปิดด้านล่าง ซึ่งไม่มีลูปปิดเหมือนกับตัวอักษร \\\"ธ\\\" การตรวจสอบนี้เป็นขั้นตอนแรกที่สำคัญในการแยกแยะความแตกต่างระหว่าง \\\"ร\\\" และ \\\"ธ\\\"\\n\\n2. **เส้นแนวนอนที่ฐาน:** อักษร \\\"ร\\\" ไม่มีเส้นแนวนอนที่ฐาน ในขณะที่อักษร \\\"ธ\\\" จะมีเส้นแนวนอนที่ฐานอย่างชัดเจน การไม่มีเส้นแนวนอนที่ฐานนี้เป็นอีกหนึ่งปัจจัยสำคัญที่ทำให้มั่นใจว่าอักษรนี้คือ \\\"ร\\\"\\n\\n3. **ลักษณะเชิงโครงสร้าง:** ตัวอักษร \\\"ร\\\" มีลักษณะที่บางและเล็กกว่าเมื่อเทียบกับ \\\"ธ\\\" การเปรียบเทียบขนาดและความหนาของตัวอักษรนี้ช่วยในการยืนยันความถูกต้องของการระบุตัวอักษร\\n\\n4. **การใช้เทคนิค OCR เฉพาะสำหรับภาษาไทย:** โมเดล OCR ที่ใช้ได้รับการฝึกฝนมาสำหรับภาษาไทยโดยเฉพาะ ทำให้สามารถจดจำและแยกแยะลักษณะเฉพาะของ \\\"ร\\\" ได้อย่างแม่นยำมากขึ้น\\n\\n5. **การตรวจสอบซ้ำด้วยอัลกอริทึมพิเศษ:** หลังจากที่ OCR ทำการอ่านครั้งแรก ระบบได้ทำการตรวจสอบซ้ำโดยใช้อัลกอริทึม feature mapping เพื่อเปรียบเทียบคุณลักษณะของตัวอักษรที่อ่านได้กับต้นแบบของ \\\"ร\\\" และ \\\"ธ\\\" อีกครั้ง เพื่อให้มั่นใจว่าการระบุตัวอักษรนั้นถูกต้องและมีความแม่นยำสูงสุด\\n\\n\\nOutput:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : Show the problem\\n- if License plate is can read and confident output of License Plate Recognition is high : Show result in this format \\\"<result>\\\"[if result is have \\\" \\\" : replace  \\\" \\\" to \\\"\\\"] is in Thai language \\n\\nExample output:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : ไม่สามารถอ่านป้ายทะเบียนได้เนื่องจากอักษรและตัวเลขของป้ายทะเบียนนั้นหายไป\\n- if License plate is can read and confident output of License Plate Recognition is high : ผจ1234\\n\\n[!!! Respond according to the Output topic specification according to the Example output topic format only . Do not create  additional format text in the Response. !!!]\"\n}\n    }\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "b0336812-0cfc-41b8-b475-b8a376980167",
      "name": "Gemini_2_flash_exp_LPR",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1280,
        -340
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "AIzaSyCIsx06N1DPeMh4wwkLFceNbgjUpkmywIc"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \" \"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $json.data[0].mime_type }}\",\n            \"file_uri\": \"{{ $json.data[0].uri }}\"\n          }\n        },\n        {\n          \"fileData\": {\n            \"mimeType\": \"{{$json.data[1].mime_type }}\",\n            \"fileUri\": \"{{ $json.data[1].uri }}\"\n            \n          }\n        }\n      ]\n    }\n  ],\n    \"generationConfig\": {\n        \"temperature\": 1,\n        \"topK\": 40,\n        \"topP\": 0.95,\n        \"maxOutputTokens\": 8192,\n        \"responseMimeType\": \"text/plain\"\n    },\n    \"system_instruction\": {\n        \"parts\": {\"text\":\"Setting:\\n- Task type: License Plate Recognition\\n- Priority: Prioritize maximum accuracy for Thai character recognition over speed.\\n\\nCommand:\\n- First, Read all frames in the video and focus only on the closest car in the video.\\n- Second, focus on the License Plate of the focused car.\\n- Third, Improve the quality of the focused license plate before reading, such as adjusting contrast, reducing noise, or adjusting brightness, and apply any relevant image processing techniques for clearer text.\\n- Fourth, read the focused license plate carefully and use OCR techniques that can handle skewness, distortion, *and specifically Thai characters with overlapping or similar shapes, especially [ย, ฉ, ธ, บ, ษ]*. Apply character segmentation methods if necessary. **Pay very close attention to the nuances of Thai characters, particularly the loop and tail structures which distinguish ย from ฉ. Employ a secondary character verification algorithm focused on the subtle differences between these commonly confused glyphs.**\\n- Fifth, Optimize the inspection even in conditions of angles or uneven lighting *by attempting to rectify perspective and compensate for shadows and glare for a clearer view*. Prioritize accuracy over speed in inspection.\\n- *Sixth, Before providing final result, apply a cross validation method by re-analyzing the results with enhanced algorithm. If any doubt arise, please re-analyze the text again. **Include a dedicated analysis step specifically comparing characters that are likely to be confused (e.g., ย/ฉ, ธ/บ) using a comparative feature mapping algorithm to maximize accurate recognition.** *\\n- Finally: Respond according to the Output topic specification according to the Example output topic format only .\\n\\nRequirements:\\n- All frames in the video must be read and analyzed one by one.\\n- The angle and lighting of the image may not be symmetrical, the system should try to improve the reading and inspection through image processing.\\n- Analyze carefully if you encounter the following letters in particular [ย, ฉ, ธ], and double check if possible with character recognition engine for Thai. **Implement a probabilistic character scoring system that favors characters with the most similar features and highest confidence scores after applying all corrective measures.**\\n- Make sure to be as accurate as possible, **even if it means taking extra time on difficult plates. Focus the character recognition engine with a specialized model for Thai text which is capable of handling the nuanced shapes.**\\n- All information must be carefully verified and compiled for further evaluation by the vehicle owner or experts. *The goal is to provide a high-accuracy result for vehicle identification.*\\n\\nSupporting Information for Analysis:\\n\\n1. **ส่วนหัวของตัวอักษร:** ส่วนหัวของ \\\"ร\\\" เป็นเส้นโค้งเปิดด้านล่าง ซึ่งไม่มีลูปปิดเหมือนกับตัวอักษร \\\"ธ\\\" การตรวจสอบนี้เป็นขั้นตอนแรกที่สำคัญในการแยกแยะความแตกต่างระหว่าง \\\"ร\\\" และ \\\"ธ\\\"\\n\\n2. **เส้นแนวนอนที่ฐาน:** อักษร \\\"ร\\\" ไม่มีเส้นแนวนอนที่ฐาน ในขณะที่อักษร \\\"ธ\\\" จะมีเส้นแนวนอนที่ฐานอย่างชัดเจน การไม่มีเส้นแนวนอนที่ฐานนี้เป็นอีกหนึ่งปัจจัยสำคัญที่ทำให้มั่นใจว่าอักษรนี้คือ \\\"ร\\\"\\n\\n3. **ลักษณะเชิงโครงสร้าง:** ตัวอักษร \\\"ร\\\" มีลักษณะที่บางและเล็กกว่าเมื่อเทียบกับ \\\"ธ\\\" การเปรียบเทียบขนาดและความหนาของตัวอักษรนี้ช่วยในการยืนยันความถูกต้องของการระบุตัวอักษร\\n\\n4. **การใช้เทคนิค OCR เฉพาะสำหรับภาษาไทย:** โมเดล OCR ที่ใช้ได้รับการฝึกฝนมาสำหรับภาษาไทยโดยเฉพาะ ทำให้สามารถจดจำและแยกแยะลักษณะเฉพาะของ \\\"ร\\\" ได้อย่างแม่นยำมากขึ้น\\n\\n5. **การตรวจสอบซ้ำด้วยอัลกอริทึมพิเศษ:** หลังจากที่ OCR ทำการอ่านครั้งแรก ระบบได้ทำการตรวจสอบซ้ำโดยใช้อัลกอริทึม feature mapping เพื่อเปรียบเทียบคุณลักษณะของตัวอักษรที่อ่านได้กับต้นแบบของ \\\"ร\\\" และ \\\"ธ\\\" อีกครั้ง เพื่อให้มั่นใจว่าการระบุตัวอักษรนั้นถูกต้องและมีความแม่นยำสูงสุด\\n\\n\\nOutput:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : Show the problem\\n- if License plate is can read and confident output of License Plate Recognition is high : Show result in this format \\\"<result>\\\"[if result is have \\\" \\\" : replace  \\\" \\\" to \\\"\\\"] is in Thai language \\n\\nExample output:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : ไม่สามารถอ่านป้ายทะเบียนได้เนื่องจากอักษรและตัวเลขของป้ายทะเบียนนั้นหายไป\\n- if License plate is can read and confident output of License Plate Recognition is high : ผจ1234\\n\\n[!!! Respond according to the Output topic specification according to the Example output topic format only . Do not create  additional format text in the Response. !!!]\"\n}\n    }\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "b15159cb-71a6-4b65-8707-96f607e13f4b",
      "name": "Gemini_2_flash_exp_LPR9",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1280,
        -180
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "AIzaSyCIsx06N1DPeMh4wwkLFceNbgjUpkmywIc"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \" \"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $json.data[0].mime_type }}\",\n            \"file_uri\": \"{{ $json.data[0].uri }}\"\n          }\n        },\n        {\n          \"fileData\": {\n            \"mimeType\": \"{{$json.data[1].mime_type }}\",\n            \"fileUri\": \"{{ $json.data[1].uri }}\"\n            \n          }\n        }\n      ]\n    }\n  ],\n    \"generationConfig\": {\n        \"temperature\": 1,\n        \"topK\": 40,\n        \"topP\": 0.95,\n        \"maxOutputTokens\": 8192,\n        \"responseMimeType\": \"text/plain\"\n    },\n    \"system_instruction\": {\n        \"parts\": {\"text\":\"Setting:\\n- Task type: License Plate Recognition\\n- Priority: Prioritize maximum accuracy for Thai character recognition over speed.\\n\\nCommand:\\n- First, Read all frames in the video and focus only on the closest car in the video.\\n- Second, focus on the License Plate of the focused car.\\n- Third, Improve the quality of the focused license plate before reading, such as adjusting contrast, reducing noise, or adjusting brightness, and apply any relevant image processing techniques for clearer text.\\n- Fourth, read the focused license plate carefully and use OCR techniques that can handle skewness, distortion, *and specifically Thai characters with overlapping or similar shapes, especially [ย, ฉ, ธ, บ, ษ]*. Apply character segmentation methods if necessary. **Pay very close attention to the nuances of Thai characters, particularly the loop and tail structures which distinguish ย from ฉ. Employ a secondary character verification algorithm focused on the subtle differences between these commonly confused glyphs.**\\n- Fifth, Optimize the inspection even in conditions of angles or uneven lighting *by attempting to rectify perspective and compensate for shadows and glare for a clearer view*. Prioritize accuracy over speed in inspection.\\n- *Sixth, Before providing final result, apply a cross validation method by re-analyzing the results with enhanced algorithm. If any doubt arise, please re-analyze the text again. **Include a dedicated analysis step specifically comparing characters that are likely to be confused (e.g., ย/ฉ, ธ/บ) using a comparative feature mapping algorithm to maximize accurate recognition.** *\\n- Finally: Respond according to the Output topic specification according to the Example output topic format only .\\n\\nRequirements:\\n- All frames in the video must be read and analyzed one by one.\\n- The angle and lighting of the image may not be symmetrical, the system should try to improve the reading and inspection through image processing.\\n- Analyze carefully if you encounter the following letters in particular [ย, ฉ, ธ], and double check if possible with character recognition engine for Thai. **Implement a probabilistic character scoring system that favors characters with the most similar features and highest confidence scores after applying all corrective measures.**\\n- Make sure to be as accurate as possible, **even if it means taking extra time on difficult plates. Focus the character recognition engine with a specialized model for Thai text which is capable of handling the nuanced shapes.**\\n- All information must be carefully verified and compiled for further evaluation by the vehicle owner or experts. *The goal is to provide a high-accuracy result for vehicle identification.*\\n\\nSupporting Information for Analysis:\\n\\n1. **ส่วนหัวของตัวอักษร:** ส่วนหัวของ \\\"ร\\\" เป็นเส้นโค้งเปิดด้านล่าง ซึ่งไม่มีลูปปิดเหมือนกับตัวอักษร \\\"ธ\\\" การตรวจสอบนี้เป็นขั้นตอนแรกที่สำคัญในการแยกแยะความแตกต่างระหว่าง \\\"ร\\\" และ \\\"ธ\\\"\\n\\n2. **เส้นแนวนอนที่ฐาน:** อักษร \\\"ร\\\" ไม่มีเส้นแนวนอนที่ฐาน ในขณะที่อักษร \\\"ธ\\\" จะมีเส้นแนวนอนที่ฐานอย่างชัดเจน การไม่มีเส้นแนวนอนที่ฐานนี้เป็นอีกหนึ่งปัจจัยสำคัญที่ทำให้มั่นใจว่าอักษรนี้คือ \\\"ร\\\"\\n\\n3. **ลักษณะเชิงโครงสร้าง:** ตัวอักษร \\\"ร\\\" มีลักษณะที่บางและเล็กกว่าเมื่อเทียบกับ \\\"ธ\\\" การเปรียบเทียบขนาดและความหนาของตัวอักษรนี้ช่วยในการยืนยันความถูกต้องของการระบุตัวอักษร\\n\\n4. **การใช้เทคนิค OCR เฉพาะสำหรับภาษาไทย:** โมเดล OCR ที่ใช้ได้รับการฝึกฝนมาสำหรับภาษาไทยโดยเฉพาะ ทำให้สามารถจดจำและแยกแยะลักษณะเฉพาะของ \\\"ร\\\" ได้อย่างแม่นยำมากขึ้น\\n\\n5. **การตรวจสอบซ้ำด้วยอัลกอริทึมพิเศษ:** หลังจากที่ OCR ทำการอ่านครั้งแรก ระบบได้ทำการตรวจสอบซ้ำโดยใช้อัลกอริทึม feature mapping เพื่อเปรียบเทียบคุณลักษณะของตัวอักษรที่อ่านได้กับต้นแบบของ \\\"ร\\\" และ \\\"ธ\\\" อีกครั้ง เพื่อให้มั่นใจว่าการระบุตัวอักษรนั้นถูกต้องและมีความแม่นยำสูงสุด\\n\\n\\nOutput:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : Show the problem\\n- if License plate is can read and confident output of License Plate Recognition is high : Show result in this format \\\"<result>\\\"[if result is have \\\" \\\" : replace  \\\" \\\" to \\\"\\\"] is in Thai language \\n\\nExample output:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : ไม่สามารถอ่านป้ายทะเบียนได้เนื่องจากอักษรและตัวเลขของป้ายทะเบียนนั้นหายไป\\n- if License plate is can read and confident output of License Plate Recognition is high : ผจ1234\\n\\n[!!! Respond according to the Output topic specification according to the Example output topic format only . Do not create  additional format text in the Response. !!!]\"\n}\n    }\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "1016e3d4-8167-4ba6-b8f2-f2b98df84b3e",
      "name": "Gemini_2_flash_exp_LPR1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1280,
        -20
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "AIzaSyCIsx06N1DPeMh4wwkLFceNbgjUpkmywIc"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \" \"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $json.data[0].mime_type }}\",\n            \"file_uri\": \"{{ $json.data[0].uri }}\"\n          }\n        },\n        {\n          \"fileData\": {\n            \"mimeType\": \"{{$json.data[1].mime_type }}\",\n            \"fileUri\": \"{{ $json.data[1].uri }}\"\n            \n          }\n        }\n      ]\n    }\n  ],\n    \"generationConfig\": {\n        \"temperature\": 1,\n        \"topK\": 40,\n        \"topP\": 0.95,\n        \"maxOutputTokens\": 8192,\n        \"responseMimeType\": \"text/plain\"\n    },\n    \"system_instruction\": {\n        \"parts\": {\"text\":\"Setting:\\n- Task type: License Plate Recognition\\n- Priority: Prioritize maximum accuracy for Thai character recognition over speed.\\n\\nCommand:\\n- First, Read all frames in the video and focus only on the closest car in the video.\\n- Second, focus on the License Plate of the focused car.\\n- Third, Improve the quality of the focused license plate before reading, such as adjusting contrast, reducing noise, or adjusting brightness, and apply any relevant image processing techniques for clearer text.\\n- Fourth, read the focused license plate carefully and use OCR techniques that can handle skewness, distortion, *and specifically Thai characters with overlapping or similar shapes, especially [ย, ฉ, ธ, บ, ษ]*. Apply character segmentation methods if necessary. **Pay very close attention to the nuances of Thai characters, particularly the loop and tail structures which distinguish ย from ฉ. Employ a secondary character verification algorithm focused on the subtle differences between these commonly confused glyphs.**\\n- Fifth, Optimize the inspection even in conditions of angles or uneven lighting *by attempting to rectify perspective and compensate for shadows and glare for a clearer view*. Prioritize accuracy over speed in inspection.\\n- *Sixth, Before providing final result, apply a cross validation method by re-analyzing the results with enhanced algorithm. If any doubt arise, please re-analyze the text again. **Include a dedicated analysis step specifically comparing characters that are likely to be confused (e.g., ย/ฉ, ธ/บ) using a comparative feature mapping algorithm to maximize accurate recognition.** *\\n- Finally: Respond according to the Output topic specification according to the Example output topic format only .\\n\\nRequirements:\\n- All frames in the video must be read and analyzed one by one.\\n- The angle and lighting of the image may not be symmetrical, the system should try to improve the reading and inspection through image processing.\\n- Analyze carefully if you encounter the following letters in particular [ย, ฉ, ธ], and double check if possible with character recognition engine for Thai. **Implement a probabilistic character scoring system that favors characters with the most similar features and highest confidence scores after applying all corrective measures.**\\n- Make sure to be as accurate as possible, **even if it means taking extra time on difficult plates. Focus the character recognition engine with a specialized model for Thai text which is capable of handling the nuanced shapes.**\\n- All information must be carefully verified and compiled for further evaluation by the vehicle owner or experts. *The goal is to provide a high-accuracy result for vehicle identification.*\\n\\nSupporting Information for Analysis:\\n\\n1. **ส่วนหัวของตัวอักษร:** ส่วนหัวของ \\\"ร\\\" เป็นเส้นโค้งเปิดด้านล่าง ซึ่งไม่มีลูปปิดเหมือนกับตัวอักษร \\\"ธ\\\" การตรวจสอบนี้เป็นขั้นตอนแรกที่สำคัญในการแยกแยะความแตกต่างระหว่าง \\\"ร\\\" และ \\\"ธ\\\"\\n\\n2. **เส้นแนวนอนที่ฐาน:** อักษร \\\"ร\\\" ไม่มีเส้นแนวนอนที่ฐาน ในขณะที่อักษร \\\"ธ\\\" จะมีเส้นแนวนอนที่ฐานอย่างชัดเจน การไม่มีเส้นแนวนอนที่ฐานนี้เป็นอีกหนึ่งปัจจัยสำคัญที่ทำให้มั่นใจว่าอักษรนี้คือ \\\"ร\\\"\\n\\n3. **ลักษณะเชิงโครงสร้าง:** ตัวอักษร \\\"ร\\\" มีลักษณะที่บางและเล็กกว่าเมื่อเทียบกับ \\\"ธ\\\" การเปรียบเทียบขนาดและความหนาของตัวอักษรนี้ช่วยในการยืนยันความถูกต้องของการระบุตัวอักษร\\n\\n4. **การใช้เทคนิค OCR เฉพาะสำหรับภาษาไทย:** โมเดล OCR ที่ใช้ได้รับการฝึกฝนมาสำหรับภาษาไทยโดยเฉพาะ ทำให้สามารถจดจำและแยกแยะลักษณะเฉพาะของ \\\"ร\\\" ได้อย่างแม่นยำมากขึ้น\\n\\n5. **การตรวจสอบซ้ำด้วยอัลกอริทึมพิเศษ:** หลังจากที่ OCR ทำการอ่านครั้งแรก ระบบได้ทำการตรวจสอบซ้ำโดยใช้อัลกอริทึม feature mapping เพื่อเปรียบเทียบคุณลักษณะของตัวอักษรที่อ่านได้กับต้นแบบของ \\\"ร\\\" และ \\\"ธ\\\" อีกครั้ง เพื่อให้มั่นใจว่าการระบุตัวอักษรนั้นถูกต้องและมีความแม่นยำสูงสุด\\n\\n\\nOutput:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : Show the problem\\n- if License plate is can read and confident output of License Plate Recognition is high : Show result in this format \\\"<result>\\\"[if result is have \\\" \\\" : replace  \\\" \\\" to \\\"\\\"] is in Thai language \\n\\nExample output:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : ไม่สามารถอ่านป้ายทะเบียนได้เนื่องจากอักษรและตัวเลขของป้ายทะเบียนนั้นหายไป\\n- if License plate is can read and confident output of License Plate Recognition is high : ผจ1234\\n\\n[!!! Respond according to the Output topic specification according to the Example output topic format only . Do not create  additional format text in the Response. !!!]\"\n}\n    }\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "ee001b08-29b8-4877-9bdc-293b8f26ba12",
      "name": "Gemini_2_flash_exp_LPR10",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1280,
        140
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "015c8c81-403f-4930-825c-050182bbf00b",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        460,
        140
      ],
      "id": "458a2698-02dd-49c8-8688-14a67aa1ff57",
      "name": "Webhook",
      "webhookId": "015c8c81-403f-4930-825c-050182bbf00b"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "AIzaSyCIsx06N1DPeMh4wwkLFceNbgjUpkmywIc"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \" \"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $json.data[0].mime_type }}\",\n            \"file_uri\": \"{{ $json.data[0].uri }}\"\n          }\n        },\n        {\n          \"fileData\": {\n            \"mimeType\": \"{{ $json.data[1].mime_type }}\",\n            \"fileUri\": \"{{ $json.data[1].uri }}\"\n            \n          }\n        }\n      ]\n    }\n  ],\n    \"generationConfig\": {\n        \"temperature\": 0.2,\n        \"topK\": 10,\n        \"topP\": 0.8,\n        \"maxOutputTokens\": 500,\n        \"responseMimeType\": \"text/plain\"\n    },\n    \"system_instruction\": {\n        \"parts\": {\"text\":\"Setting:\\n- Task type: License Plate Recognition\\n- Priority: Prioritize maximum accuracy for Thai character recognition over speed.\\n\\nCommand:\\n- First, Read all frames in the video and focus only on the closest car in the video.\\n- Second, focus on the License Plate of the focused car.\\n- Third, Improve the quality of the focused license plate before reading, such as adjusting contrast, reducing noise, or adjusting brightness, and apply any relevant image processing techniques for clearer text.\\n- Fourth, read the focused license plate carefully and use OCR techniques that can handle skewness, distortion, *and specifically Thai characters with overlapping or similar shapes, especially [ย, ฉ, ธ, บ, ษ]*. Apply character segmentation methods if necessary. **Pay very close attention to the nuances of Thai characters, particularly the loop and tail structures which distinguish ย from ฉ. Employ a secondary character verification algorithm focused on the subtle differences between these commonly confused glyphs.**\\n- Fifth, Optimize the inspection even in conditions of angles or uneven lighting *by attempting to rectify perspective and compensate for shadows and glare for a clearer view*. Prioritize accuracy over speed in inspection.\\n- *Sixth, Before providing final result, apply a cross validation method by re-analyzing the results with enhanced algorithm. If any doubt arise, please re-analyze the text again. **Include a dedicated analysis step specifically comparing characters that are likely to be confused (e.g., ย/ฉ, ธ/บ) using a comparative feature mapping algorithm to maximize accurate recognition.** *\\n- Finally: Respond according to the Output topic specification according to the Example output topic format only .\\n\\nRequirements:\\n- All frames in the video must be read and analyzed one by one.\\n- The angle and lighting of the image may not be symmetrical, the system should try to improve the reading and inspection through image processing.\\n- Analyze carefully if you encounter the following letters in particular [ย, ฉ, ธ], and double check if possible with character recognition engine for Thai. **Implement a probabilistic character scoring system that favors characters with the most similar features and highest confidence scores after applying all corrective measures.**\\n- Make sure to be as accurate as possible, **even if it means taking extra time on difficult plates. Focus the character recognition engine with a specialized model for Thai text which is capable of handling the nuanced shapes.**\\n- All information must be carefully verified and compiled for further evaluation by the vehicle owner or experts. *The goal is to provide a high-accuracy result for vehicle identification.*\\n\\nSupporting Information for Analysis:\\n\\n1. **ส่วนหัวของตัวอักษร:** ส่วนหัวของ \\\"ร\\\" เป็นเส้นโค้งเปิดด้านล่าง ซึ่งไม่มีลูปปิดเหมือนกับตัวอักษร \\\"ธ\\\" การตรวจสอบนี้เป็นขั้นตอนแรกที่สำคัญในการแยกแยะความแตกต่างระหว่าง \\\"ร\\\" และ \\\"ธ\\\"\\n\\n2. **เส้นแนวนอนที่ฐาน:** อักษร \\\"ร\\\" ไม่มีเส้นแนวนอนที่ฐาน ในขณะที่อักษร \\\"ธ\\\" จะมีเส้นแนวนอนที่ฐานอย่างชัดเจน การไม่มีเส้นแนวนอนที่ฐานนี้เป็นอีกหนึ่งปัจจัยสำคัญที่ทำให้มั่นใจว่าอักษรนี้คือ \\\"ร\\\"\\n\\n3. **ลักษณะเชิงโครงสร้าง:** ตัวอักษร \\\"ร\\\" มีลักษณะที่บางและเล็กกว่าเมื่อเทียบกับ \\\"ธ\\\" การเปรียบเทียบขนาดและความหนาของตัวอักษรนี้ช่วยในการยืนยันความถูกต้องของการระบุตัวอักษร\\n\\n4. **การใช้เทคนิค OCR เฉพาะสำหรับภาษาไทย:** โมเดล OCR ที่ใช้ได้รับการฝึกฝนมาสำหรับภาษาไทยโดยเฉพาะ ทำให้สามารถจดจำและแยกแยะลักษณะเฉพาะของ \\\"ร\\\" ได้อย่างแม่นยำมากขึ้น\\n\\n5. **การตรวจสอบซ้ำด้วยอัลกอริทึมพิเศษ:** หลังจากที่ OCR ทำการอ่านครั้งแรก ระบบได้ทำการตรวจสอบซ้ำโดยใช้อัลกอริทึม feature mapping เพื่อเปรียบเทียบคุณลักษณะของตัวอักษรที่อ่านได้กับต้นแบบของ \\\"ร\\\" และ \\\"ธ\\\" อีกครั้ง เพื่อให้มั่นใจว่าการระบุตัวอักษรนั้นถูกต้องและมีความแม่นยำสูงสุด\\n\\n\\nOutput:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : Show the problem\\n- if License plate is can read and confident output of License Plate Recognition is high : Show result in this format \\\"<result>\\\"[if result is have \\\" \\\" : replace  \\\" \\\" to \\\"\\\"] is in Thai language \\n\\nExample output:\\n- if License plate is can not read or confident output of License Plate Recognition is low  : ไม่สามารถอ่านป้ายทะเบียนได้เนื่องจากอักษรและตัวเลขของป้ายทะเบียนนั้นหายไป\\n- if License plate is can read and confident output of License Plate Recognition is high : ผจ1234\\n\\n[!!! Respond according to the Output topic specification according to the Example output topic format only . Do not create  additional format text in the Response. !!!]\"\n}\n    }\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "283cae82-faa5-45ce-80a2-4177f87417ca",
      "name": "Gemini_2_flash_exp_LPR2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1280,
        -500
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "body.data",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        700,
        140
      ],
      "id": "041a5ce0-94d0-46f6-b801-4d3c090acb25",
      "name": "Split Out"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        920,
        140
      ],
      "id": "bb090495-a0e9-45b1-be6b-01cfe9ae366b",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "AIzaSyCIsx06N1DPeMh4wwkLFceNbgjUpkmywIc"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \" \"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $json.mime_type }}\",\n            \"file_uri\": \"{{ $json.uri }}\"\n          }\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n      \"temperature\": 0.5,\n      \"topK\": 20,\n      \"topP\": 0.9,\n      \"maxOutputTokens\": 1000,\n      \"responseMimeType\": \"text/plain\"\n  },\n    \"system_instruction\": {\n        \"parts\": {\"text\":\"Setting:\\n- Task type: Car Damage Assessment\\n\\nCommand:\\n- First, Read all frame in the video and focus only on the closest car video.\\n- Second, focus each automotive parts of focused car.\\n- Third, carefully inspect and assess  each  focused automotive  part for any clearly visible [scratches], [dents], [cracks], [fractures on the plastic or glass around the front or tail light], [other types of damage] or [Everything is wrong when compared to a new car].\\n- Fourth,Optimize the inspection even in conditions of angles or uneven lighting for the most accurate inspection.\\n- Finally:Respond according to the Output topic specification according to the Example output topic format only .\\n\\n\\nRequirements:\\n- All frames in the video must be read and analyzed one by one.\\n- The angle and lighting of the image may not be symmetrical, the system tries to improve the reading and inspection.\\n- Make sure to be as accurate as possible.\\n- All information must be carefully verified and compiled for further evaluation by the vehicle owner or experts.\\n\\n\\n\\nOutput:\\n- If the imported video is not have vehicle in any frame: Confirm that the inspection is complete and Describe the video you see and what it is.\\n- If the mostly frame in imported video is show a car interior : Confirm that the inspection is complete, not automotive  part.\\n- If no damage is found: Confirm that the inspection is complete, no damage.\\n- If damage is found: Response in this format \\\"<type of damage  point you can see> in <automotive parts you see that point >\\\" in Thai language. is in order 1,2,3,... \\n\\nExample output:\\n- If input video is not vehicle: ภาพที่แสดงเป็นป้ายภาษีประจำปีที่ติดอยู่ภายในรถยนต์\\n\\n- If the mostly frame in imported video is show a car interior : ส่วนใหญ่แสดงเป็นภายในของรถยนต์\\n\\n- If no damage is found: การตรวจสอบ ไม่พบความเสียหาย\\n\\n- If damage is found: \\n  1.รอยบุบ บริเวณ กันชนหน้า \\n  2.รอยขีดข่วน บริเวณ กันชนหน้า (ส่วนล่างของรถ) ใกล้กับรอยบุบ\\n  3.ไฟท้ายแตกร้าว \\n  4.ไฟท้ายมีชิ้นส่วนขาดหาย \\n  5.รอยสนิม บริเวณ กันชนหน้า (ส่วนบนของรถ)\\n  6.รอยสีลอก บริเวณ กันชนหลัง (ส่วนบนของรถ)\\n\\n[!!! Respond according to the Output topic specification according to the Example output topic format only . Do not create  additional format text in the Response. !!!]\"\n}\n    }\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "d4d6b6d0-65ea-40ce-8f6a-56c47593ccfa",
      "name": "Gemini_2_flash_exp_CDA4",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        520,
        720
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"{{ $json.data[0].display_name.split(\".\")[0] }}\": \"{{ $json.data[0].myNewField.candidates[0].content.parts[0].text.trim() }}\",\n  \"{{ $json.data[1].display_name.split(\".\")[0] }}\": \"{{ $json.data[1].myNewField.candidates[0].content.parts[0].text.trim() }}\",\n  \"{{ $json.data[2].display_name.split(\".\")[0] }}\": \"{{ $json.data[2].myNewField.candidates[0].content.parts[0].text.trim() }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        1340,
        700
      ],
      "id": "a1d2eaa1-105d-4e00-ac41-226ad0d6ad57",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "035e9e09-799e-4578-85ff-7b073fef7095",
      "name": "Aggregate3",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        1160,
        700
      ]
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [
        740,
        700
      ],
      "id": "a00ee62e-8fad-4e4e-8363-263249f2aa01",
      "name": "Merge"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "# Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfor idx,item in enumerate(_input.all()[0:3]):\n  item.json.myNewField = _input.all()[3+idx].json\nreturn _input.all()[0:3]"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        980,
        700
      ],
      "id": "521f8ffe-1615-467a-be1b-e717c9765e3d",
      "name": "Code4"
    },
    {
      "parameters": {
        "content": "# ระบบจดจำป้ายทะเบียนรถยนต์ภาษาไทยโดยใช้ AI และการประมวลผลภาพ มีขั้นตอนการทำงานหลักดังนี้:\n\n## การรวมและประมวลผลข้อมูล\n\n1. Node \"Aggregate\" รวบรวมข้อมูลจากทุก item เข้าด้วยกัน\n2. ข้อมูลถูกส่งไปยัง 5 node Gemini AI (LPR2, LPR, LPR9, LPR1, LPR10) เพื่อวิเคราะห์ภาพและอ่านป้ายทะเบียน\n3. ผลลัพธ์จากทั้ง 5 node ถูกรวมเข้าด้วยกันที่ node \"Merge2\"\n\n## การวิเคราะห์และปรับปรุงผลลัพธ์\n\n4. Node \"Aggregate2\" รวมผลลัพธ์ทั้งหมด\n5. \"Edit Fields4\" จัดรูปแบบข้อมูลให้เป็น JSON\n6. \"Code2\" ใช้ Python เพื่อกำจัดผลลัพธ์ที่ซ้ำกัน\n\n## การตรวจสอบและยืนยันผล\n\n7. \"Gemini_2_flash_exp_CDA2\" ใช้ AI วิเคราะห์ผลลัพธ์อีกครั้งเพื่อเพิ่มความแม่นยำ\n8. \"Execute Workflow\" ใช้สำหรับดำเนินการแจ้งเตือนหากป้ายทะเบียนของรถยนต์ที่อ่านได้ตรงกับข้อมูลของลูกค้าที่มีการนัดหมายเข้าใช้บริการในวันนั้น\n\nFlow นี้ออกแบบมาเพื่อเพิ่มความแม่นยำในการอ่านป้ายทะเบียนภาษาไทย โดยใช้การวิเคราะห์หลายครั้งและการตรวจสอบซ้ำเพื่อจัดการกับความท้าทายในการแยกแยะตัวอักษรไทยที่คล้ายกัน เช่น ย, ฉ, ธ\n",
        "height": 920,
        "width": 2580
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -200,
        -580
      ],
      "typeVersion": 1,
      "id": "874add14-9d04-40e7-963c-8fce76ec1d85",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "# Flow n8n นี้เป็นระบบประเมินความเสียหายของรถยนต์โดยใช้ AI วิเคราะห์ภาพวิดีโอ มีขั้นตอนการทำงานดังนี้:\n\n## การวิเคราะห์ภาพด้วย AI\n\n1. **Gemini_2_flash_exp_CDA4**: ส่งข้อมูลภาพไปยัง Gemini AI API เพื่อวิเคราะห์ความเสียหายของรถยนต์\n   - ใช้ POST request ไปยัง API ของ Gemini\n   - ส่งภาพพร้อมคำสั่งเฉพาะสำหรับการประเมินความเสียหาย\n   - กำหนดค่าพารามิเตอร์ต่างๆ เช่น temperature, topK, topP สำหรับการสร้างผลลัพธ์\n\n## การประมวลผลข้อมูล\n\n2. **Merge**: รวมผลลัพธ์จาก Gemini AI กับข้อมูลอื่นๆ\n\n3. **Code4**: ใช้ Python script เพื่อ:\n   - วนลูปผ่านข้อมูลนำเข้า\n   - เพิ่มฟิลด์ 'myNewField' ให้กับแต่ละรายการ JSON\n   - รวมผลลัพธ์จาก Gemini AI เข้ากับข้อมูลเดิม\n\n4. **Aggregate3**: รวมข้อมูลทั้งหมดเข้าด้วยกัน\n\n## การส่งผลลัพธ์\n\n5. **Respond to Webhook**: ส่งผลลัพธ์กลับในรูปแบบ JSON\n   - แปลงชื่อไฟล์เป็นคีย์ใน JSON\n   - ตัดช่องว่างออกจากผลลัพธ์ของ Gemini AI\n\nFlow นี้ออกแบบมาเพื่อประเมินความเสียหายของรถยนต์จากภาพวิดีโอโดยอัตโนมัติ \n-ใช้ AI วิเคราะห์ภาพและสรุปผลในรูปแบบที่เข้าใจง่าย \n-เหมาะสำหรับการใช้งานในอุตสาหกรรมประกันภัยหรือศูนย์ซ่อมรถยนต์\n\n",
        "height": 780,
        "width": 1760,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -200,
        380
      ],
      "typeVersion": 1,
      "id": "af4b20a5-41ca-4167-8b0b-1114069621a9",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "### ส่งไปยัง flow ที่ทำหน้าที่เทียบข้อมูลป้ายทะเบียนของรถยนต์ที่อ่านได้ และ แจ้งเตือน\n**หากป้ายทะเบียนของรถยนต์ที่อ่านได้ ตรงกับข้อมูลของลูกค้าที่มีการนัดหมายเข้าใช้บริการในวันนั้น จะทำการแจ้งเตือนทีมที่เกี่ยวข้องว่าลูกค้าได้มาถึงศูนย์บริการแล้ว",
        "height": 440,
        "width": 380
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2420,
        -100
      ],
      "typeVersion": 1,
      "id": "81c05cd5-7064-4292-926d-adffb0c6306a",
      "name": "Sticky Note2"
    }
  ],
  "connections": {
    "Merge2": {
      "main": [
        [
          {
            "node": "Aggregate2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate2": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields4": {
      "main": [
        [
          {
            "node": "Code2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code2": {
      "main": [
        [
          {
            "node": "Gemini_2_flash_exp_CDA2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini_2_flash_exp_CDA2": {
      "main": [
        [
          {
            "node": "Execute Workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini_2_flash_exp_LPR": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Gemini_2_flash_exp_LPR9": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Gemini_2_flash_exp_LPR1": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "Gemini_2_flash_exp_LPR10": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 4
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini_2_flash_exp_LPR2": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Gemini_2_flash_exp_CDA4",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          },
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Gemini_2_flash_exp_LPR2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gemini_2_flash_exp_LPR",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gemini_2_flash_exp_LPR9",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gemini_2_flash_exp_LPR1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gemini_2_flash_exp_LPR10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini_2_flash_exp_CDA4": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Respond to Webhook": {
      "main": [
        []
      ]
    },
    "Aggregate3": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Code4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code4": {
      "main": [
        [
          {
            "node": "Aggregate3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {
    "Webhook": [
      {
        "headers": {
          "host": "n8n.agilesoftgroup.com",
          "user-agent": "python-requests/2.32.3",
          "content-length": "1562",
          "accept": "*/*",
          "accept-encoding": "gzip, br",
          "cdn-loop": "cloudflare; loops=1",
          "cf-connecting-ip": "247.247.160.228",
          "cf-connecting-ipv6": "2403:6200:8813:e06e:9e13:eab3:16d8:2da7",
          "cf-ipcountry": "TH",
          "cf-pseudo-ipv4": "247.247.160.228",
          "cf-ray": "903773c8bd33fceb-SIN",
          "cf-visitor": "{\"scheme\":\"https\"}",
          "cf-warp-tag-id": "0acecf9e-a8e4-4d13-a197-e830684f0f5f",
          "connection": "keep-alive",
          "content-type": "application/json",
          "x-forwarded-for": "247.247.160.228",
          "x-forwarded-proto": "https"
        },
        "params": {},
        "query": {},
        "body": {
          "data": [
            {
              "name": "files/pcbj9h0kcue9",
              "display_name": "output_front_ID2.mp4",
              "mime_type": "video/mp4",
              "size_bytes": "32911684",
              "create_time": "2025-01-17T15:41:09.121821Z",
              "update_time": "2025-01-17T15:41:13.633322Z",
              "expiration_time": "2025-01-19T15:41:09.118537913Z",
              "sha256_hash": "NmEwOTM3MWY5ZmE5NDJmYTliOWFkMDZiNjA4ODE4ZDE3OTY4ZDg1YzRhYjZjYmEwYWMyZDQ1YzU4NDBiNDU3ZA==",
              "uri": "https://generativelanguage.googleapis.com/v1beta/files/pcbj9h0kcue9",
              "state": "ACTIVE",
              "video_metadata": {
                "video_duration": "22s"
              }
            },
            {
              "name": "files/qbwbj3o425op",
              "display_name": "output_back_ID2.mp4",
              "mime_type": "video/mp4",
              "size_bytes": "33300294",
              "create_time": "2025-01-17T15:41:30.305387Z",
              "update_time": "2025-01-17T15:41:35.745224Z",
              "expiration_time": "2025-01-19T15:41:30.288590741Z",
              "sha256_hash": "NGQ3MmEwNTU1M2EzNzJiMTQ3MWZiYzkzYTViYmZiMjcwM2IxNWIxNzkwNWFiZTRlNmRkYTUxMTcxMGYxYTIyMA==",
              "uri": "https://generativelanguage.googleapis.com/v1beta/files/qbwbj3o425op",
              "state": "ACTIVE",
              "video_metadata": {
                "video_duration": "22s"
              }
            },
            {
              "name": "files/8swujwz11eet",
              "display_name": "output_side_ID2.mp4",
              "mime_type": "video/mp4",
              "size_bytes": "32914739",
              "create_time": "2025-01-17T15:41:50.252642Z",
              "update_time": "2025-01-17T15:41:55.405213Z",
              "expiration_time": "2025-01-19T15:41:50.226630203Z",
              "sha256_hash": "MzRlZDRjMWQ4YmVlOTExNTRmZWQxZDJlODc2ODgwNDI4NTAzZTVjYmYyNDRiZWIxNWE2MTYwYmQyZDgyMmMyNQ==",
              "uri": "https://generativelanguage.googleapis.com/v1beta/files/8swujwz11eet",
              "state": "ACTIVE",
              "video_metadata": {
                "video_duration": "22s"
              }
            }
          ]
        },
        "webhookUrl": "https://n8n.agilesoftgroup.com/webhook-test/015c8c81-403f-4930-825c-050182bbf00b",
        "executionMode": "test"
      }
    ]
  }
};

        // ตั้งค่าข้อมูลใน n8n-demo
        const n8nDemo = document.querySelector("n8n-demo");
        n8nDemo.workflow = JSON.stringify(workflowData);
    </script>
</body>
</html>
